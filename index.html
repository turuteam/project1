<head>
<title>Headphone connection test</title>
</head>

<body>
<p>Expected outcome: Pressing test reveals if headphone's plugged in / not plugged in</p>
<button type="button" name="button">Test</button>

<script type="text/javascript">
  'use strict';

  // NOTE The label here is in fact the name of headphone jack's driver,
  // not the specific headset's device info
  // TODO Configure this
  var HEADSET_LABEL = "Headphones (Cirrus Logic CS4208 (AB 126))";

  document.querySelector("button[name='button']").onclick = function(){
    navigator.mediaDevices.enumerateDevices().then(function(MediaDeviceInfo) {
      var filtered = MediaDeviceInfo.filter(function(device){
        return device.kind == "audiooutput";
      });
      if (filtered.length !== 0) {
        alert(`Headphone ${HEADSET_LABEL} is plugged in.`);
      } else {
        alert(`Headphone ${HEADSET_LABEL} is not plugged in.`);
      }
    });
  };
</script>

</body>
